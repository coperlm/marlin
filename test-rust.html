<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœŸæ­£çš„Rustè°ƒç”¨æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="rust-marlin-client.js"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-3xl font-bold text-center mb-8">ğŸ¦€ çœŸæ­£çš„Ruståº•å±‚è°ƒç”¨æµ‹è¯•</h1>
            
            <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6">
                <strong>âœ… ç°åœ¨ç›´æ¥è°ƒç”¨æœ¬åœ°Rustç¨‹åºï¼</strong>
                <p class="text-sm mt-1">æ¯æ¬¡ç‚¹å‡»éƒ½ä¼šæ‰§è¡ŒçœŸå®çš„marlin_demo.exe</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-xl font-semibold mb-4">æ­£ç¡®çº¦æŸæµ‹è¯•</h2>
                    <p class="text-gray-600 mb-4">3 Ã— 5 = 15 (åº”è¯¥éªŒè¯é€šè¿‡)</p>
                    <button onclick="testCorrectConstraint()" 
                            class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
                        æµ‹è¯•æ­£ç¡®çº¦æŸ
                    </button>
                </div>

                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-xl font-semibold mb-4">é”™è¯¯çº¦æŸæµ‹è¯•</h2>
                    <p class="text-gray-600 mb-4">3 Ã— 5 = 16 (åº”è¯¥éªŒè¯å¤±è´¥)</p>
                    <button onclick="testIncorrectConstraint()" 
                            class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
                        æµ‹è¯•é”™è¯¯çº¦æŸ
                    </button>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">ğŸ” æ‰§è¡Œæ—¥å¿—</h2>
                <div id="logs" class="bg-gray-900 text-green-400 p-4 rounded font-mono text-sm h-96 overflow-y-auto">
                    <div>ç­‰å¾…æµ‹è¯•...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let client = null;
        
        async function initClient() {
            if (!client) {
                client = new RustMarlinClient();
                try {
                    await client.checkServerHealth();
                    log('âœ… è¿æ¥åˆ°Rustæ¡¥æ¥æœåŠ¡å™¨æˆåŠŸ');
                } catch (error) {
                    log('âŒ æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨: ' + error.message);
                    log('è¯·ç¡®ä¿è¿è¡Œ: npm start');
                }
            }
            return client;
        }

        async function testCorrectConstraint() {
            const client = await initClient();
            log('ğŸ§ª å¼€å§‹æµ‹è¯•æ­£ç¡®çº¦æŸ: 3 Ã— 5 = 15');
            
            try {
                const result = await client.fullDemo(3, 5, 15);
                log('ğŸ“Š Rustç¨‹åºè¿”å›ç»“æœ:');
                log(JSON.stringify(result, null, 2));
                
                if (result.proof_verification) {
                    log('âœ… æµ‹è¯•é€šè¿‡ï¼çº¦æŸéªŒè¯æˆåŠŸ');
                } else {
                    log('âŒ æ„å¤–ç»“æœï¼šæ­£ç¡®çº¦æŸéªŒè¯å¤±è´¥');
                }
            } catch (error) {
                log('âŒ æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }

        async function testIncorrectConstraint() {
            const client = await initClient();
            log('ğŸ§ª å¼€å§‹æµ‹è¯•é”™è¯¯çº¦æŸ: 3 Ã— 5 = 16');
            
            try {
                const result = await client.fullDemo(3, 5, 16);
                log('ğŸ“Š Rustç¨‹åºè¿”å›ç»“æœ:');
                log(JSON.stringify(result, null, 2));
                
                if (!result.proof_verification) {
                    log('âœ… æµ‹è¯•é€šè¿‡ï¼é”™è¯¯çº¦æŸè¢«æ­£ç¡®æ£€æµ‹');
                    if (result.raw_output && result.raw_output.includes('PC::Check failed')) {
                        log('âœ… ç¡®è®¤ï¼šRustç¨‹åºè¿”å›äº†PC::Check failed');
                    }
                } else {
                    log('âŒ æ„å¤–ç»“æœï¼šé”™è¯¯çº¦æŸæœªè¢«æ£€æµ‹');
                }
            } catch (error) {
                log('âŒ æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }

        function log(message) {
            const logsDiv = document.getElementById('logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        // åˆå§‹åŒ–æ—¶æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
        window.addEventListener('load', initClient);
    </script>
</body>
</html>